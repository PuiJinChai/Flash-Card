<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>第二课 戴花脸的乐趣｜听写生词字卡</title>
<style>
:root{
  --bg1: #e8f9e9;
  --bg2: #f6fff6;
  --card-bg-front: #e6fff1;
  --card-bg-back: #ffffff;
  --accent: #2e5f49;
  --btn-bg: #1e90ff;
  --btn-text: #fff;
}
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  font-family: "PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft YaHei","Arial", sans-serif;
  background: linear-gradient(180deg,var(--bg1),var(--bg2));
  color: #233;
}
.header{
  background:#b8e4c9;
  color:var(--accent);
  text-align:center;
  padding:14px 12px;
  font-size:18px;
  box-shadow:0 2px 6px rgba(0,0,0,0.08);
  font-weight:600;
}
.wrapper{
  min-height: calc(100vh - 140px);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
  padding-bottom:140px;
}
.card-area{
  width:92%;
  max-width:460px;
  display:flex;
  justify-content:center;
  align-items:center;
}
.card{
  width:100%;
  max-width:420px;
  height:320px;
  perspective:1200px;
  position:relative;
  user-select:none;
}
.inner{
  width:100%;
  height:100%;
  position:relative;
  transition: transform 0.75s cubic-bezier(.2,.9,.3,1);
  transform-style: preserve-3d;
}
.card.flipped .inner{
  transform: rotateY(180deg) scale(1.05);
}
.card.flip-animate{
  animation: bounceFlip 0.4s ease;
}
@keyframes bounceFlip{
  0% {transform: scale(1);}
  50% {transform: scale(1.08);}
  100% {transform: scale(1);}
}
.face{
  position:absolute;
  inset:0;
  border-radius:20px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:18px;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  overflow:hidden;
}
.front{
  background: var(--card-bg-front);
}
.back{
  background: var(--card-bg-back);
  transform: rotateY(180deg);
}
.pinyin{
  font-size:48px;
  line-height:1.0;
  color:#2a9d66;
  letter-spacing:2px;
  text-align:center;
  word-break:break-word;
  padding:6px 8px;
  font-weight:600;
}
.speaker-btn{
  margin-top:10px;
  background:transparent;
  border:none;
  width:44px;
  height:44px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border-radius:50%;
  cursor:pointer;
}
.speaker-btn:active{transform:scale(0.98)}
.speaker-icon{
  width:26px;height:26px;
  fill: #1e90ff;
}
.lesson{
  position:absolute;
  right:14px;
  bottom:12px;
  font-size:13px;
  color:#666;
}
.word{
  font-family: "KaiTi","SimKai","楷体", serif;
  font-size:34px;
  color:#111;
  margin-bottom:6px;
  text-align:center;
  word-break:break-word;
}
.meaning{
  font-size:20px;
  color:green;
  margin-bottom:10px;
  text-align:center;
}
.sentence{
  font-family:"KaiTi","SimKai","楷体",serif;
  font-size:17px;
  color:#333;
  text-align:center;
  padding:0 8px;
  line-height:1.35;
}
.sentence .speak-inline{
  margin-left:8px;
  vertical-align:middle;
}
.translation{
  margin-top:6px;
  font-size:15px;
  color:#555;
  text-align:center;
}
.nav{
  position:fixed;
  left:0;
  right:0;
  bottom:18px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  pointer-events: auto;
}
.nav-inner{
  display:flex;
  gap:20px;
  align-items:center;
  justify-content:center;
  background:rgba(255,255,255,0.0);
  padding:6px 12px;
}
.nav button{
  background:var(--btn-bg);
  color:var(--btn-text);
  border:none;
  padding:12px 22px;
  border-radius:12px;
  font-size:16px;
  box-shadow:0 6px 16px rgba(30,144,255,0.18);
  cursor:pointer;
}
.nav button:active{transform:translateY(1px)}
.counter{
  margin-top:6px;
  text-align:center;
  font-size:13px;
  color:#444;
}
.dots span{
  display:inline-block;
  width:10px;
  height:10px;
  margin:0 4px;
  border-radius:50%;
  background:#c0c0c0;
  transition:all 0.3s;
}
.dots span.active{
  background:#1e90ff;
  transform:scale(1.3);
}
@media(max-width:420px){
  .card { height:360px; border-radius:18px; }
  .pinyin { font-size:54px; }
  .word { font-size:36px; }
  .meaning { font-size:18px; }
  .sentence { font-size:18px; }
  .nav button { padding:12px 18px; font-size:17px; border-radius:14px; }
  .header { font-size:16px; padding:12px 8px; }
  .dots span { width:12px; height:12px; margin:0 3px; }
}
</style>
</head>
<body>
<div class="header">第二课 戴花脸的乐趣｜听写生词字卡</div>
<div class="wrapper">
  <div class="card-area" aria-live="polite">
    <div class="card" id="card" role="button" aria-pressed="false" tabindex="0" aria-label="单张字卡，点击翻面">
      <div class="inner" id="inner"></div>
    </div>
  </div>
</div>

<div class="nav" role="navigation" aria-label="卡片导航">
  <div class="nav-inner">
    <button id="prevBtn" aria-label="上一页">⬅ 上一张</button>
    <div class="counter" id="counter">1 / 16</div>
    <button id="nextBtn" aria-label="下一页">下一张 ➡</button>
  </div>
  <div class="dots" id="dotsContainer"></div>
</div>

<script>
const words = [
{word:"春节", pinyin:"chūn jié", meaning:"Chinese New Year", sentence:"我们非常期待春节到来。", en:"We are really looking forward to Chinese New Year."},
{word:"年货", pinyin:"nián huò", meaning:"goods for Chinese New Year", sentence:"妈妈买了很多年货准备过年。", en:"Mom bought many goods for Chinese New Year."},
{word:"惊喜", pinyin:"jīng xǐ", meaning:"surprise/pleasant surprise", sentence:"今天是小明的生日，我们要给他一个惊喜！", en:"Today is Xiaoming's birthday, we are going to give him a surprise!"},
{word:"与众不同", pinyin:"yǔ zhòng bù tóng", meaning:"out of the ordinary", sentence:"她的衣服很与众不同。", en:"Her clothes are out of the ordinary."},
{word:"咄咄逼人", pinyin:"duō duō bī rén", meaning:"aggressive (in words)", sentence:"他的态度有点咄咄逼人。", en:"His attitude is a bit aggressive."},
{word:"爱不释手", pinyin:"ài bú shì shǒu", meaning:"love something too much to part with it", sentence:"这个玩具让我爱不释手。", en:"I love this toy too much to put it down."},
{word:"主角", pinyin:"zhǔ jué", meaning:"main character/leading role", sentence:"她在话剧里是主角。", en:"She is the main character in the play."},
{word:"全副武装", pinyin:"quán fù wǔ zhuāng", meaning:"full armor/be fully armed", sentence:"士兵全副武装出发了。", en:"The soldiers set off fully armed."},
{word:"羡慕", pinyin:"xiàn mù", meaning:"envy", sentence:"我很羡慕他的画画能力。", en:"I envy his drawing skills."},
{word:"摇晃", pinyin:"yáo huàng", meaning:"shake", sentence:"那棵树在风中摇晃。", en:"The tree is shaking in the wind."},
{word:"肩膀", pinyin:"jiān bǎng", meaning:"shoulder", sentence:"他拍拍我的肩膀说：“别放弃！”", en:"He patted my shoulder and said: 'Don't give up!'"},
{word:"拜年", pinyin:"bài nián", meaning:"make/pay a New Year visit", sentence:"我们去爷爷家拜年。", en:"We went to Grandpa's house to pay a New Year visit."},
{word:"衣服", pinyin:"yī fu", meaning:"clothes", sentence:"她的新衣服很漂亮。", en:"Her new clothes are very beautiful."},
{word:"哄堂大笑", pinyin:"hōng táng dà xiào", meaning:"the whole room bursting into laughter", sentence:"老师讲笑话时，大家哄堂大笑。", en:"Everyone burst into laughter when the teacher told a joke."},
{word:"神气", pinyin:"shén qì", meaning:"energetic", sentence:"弟弟穿着童军制服，看起来很神气。", en:"My little brother looks very energetic in his scout uniform."},
{word:"张牙舞爪", pinyin:"zhāng yá wǔ zhǎo", meaning:"be fierce-looking", sentence:"小猫看到老鼠便张牙舞爪地扑了过去。", en:"The kitten saw the mouse and pounced fiercely."}
];

const inner = document.getElementById('inner');
const cardEl = document.getElementById('card');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const counter = document.getElementById('counter');
const dotsContainer = document.getElementById('dotsContainer');

let current = 0;
let isBack = false;

function renderCard(i){
  const w = words[i];
  counter.textContent = `${i+1} / ${words.length}`;
  inner.innerHTML = `
    <div class="face front" data-face="front">
      <div class="pinyin" id="pinyinText">${w.pinyin}</div>
      <button class="speaker-btn" id="pinyinSpeak" aria-label="播放中文读音">
        <svg class="speaker-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 10v4h4l5 4V6L7 10H3z"></path>
        </svg>
      </button>
      <div class="lesson">第二课 戴花脸的乐趣 (${i+1}/${words.length})</div>
    </div>
    <div class="face back" data-face="back">
      <div class="word">${w.word}</div>
      <div class="meaning">${w.meaning}</div>
      <div class="sentence">
        <span id="sentenceText">${w.sentence}</span>
        <button class="speaker-btn speak-inline" id="sentenceSpeak" aria-label="播放造句">
          <svg class="speaker-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 10v4h4l5 4V6L7 10H3z"></path>
          </svg>
        </button>
      </div>
      <div class="translation">${w.en}</div>
    </div>
  `;
  cardEl.classList.remove('flipped');
  isBack = false;

  const pSpeak = document.getElementById('pinyinSpeak');
  const sSpeak = document.getElementById('sentenceSpeak');
  if(pSpeak) pSpeak.addEventListener('click', (e)=>{
    e.stopPropagation();
    playChineseText(w.word, 0.5);
  });
  if(sSpeak) sSpeak.addEventListener('click', (e)=>{
    e.stopPropagation();
    playChineseText(w.sentence, 0.6);
  });
}

function playChineseText(text, rate=0.6){
  if(!('speechSynthesis' in window)) return alert('您的浏览器不支持语音合成，请使用新版浏览器播放。');
  window.speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'zh-CN';
  u.rate = rate;
  window.speechSynthesis.speak(u);
}

function playFlipSound(){
  try{
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const buffer = ctx.createBuffer(1, ctx.sampleRate*0.08, ctx.sampleRate);
    const data = buffer.getChannelData(0);
    for(let i=0;i<data.length;i++){
      const env=Math.pow(1-i/data.length,2.2);
      data[i]=(Math.random()*2-1)*0.15*env;
    }
    const source = ctx.createBufferSource();
    source.buffer=buffer;
    const filter = ctx.createBiquadFilter();
    filter.type='highpass';
    filter.frequency.value=1000;
    const gain=ctx.createGain();
    gain.gain.value=0.9;
    source.connect(filter).connect(gain).connect(ctx.destination);
    source.start(0);
    source.stop(ctx.currentTime+0.09);
  }catch(e){console.warn(e);}
}

cardEl.addEventListener('click', function(e){
  if(e.target.closest('button') || e.target.tagName === 'BUTTON' || e.target.closest('svg')) return;
  toggleFlip();
});
cardEl.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleFlip(); }
});
function toggleFlip(){
  playFlipSound();
  cardEl.classList.add('flip-animate');
  setTimeout(()=> cardEl.classList.remove('flip-animate'),400);
  cardEl.classList.toggle('flipped');
  isBack = !isBack;
}

function goTo(index){
  if(index<0) index=words.length-1;
  if(index>=words.length) index=0;
  current=index;
  cardEl.classList.add('flip-animate');
  setTimeout(()=>{
    renderCard(current);
    cardEl.classList.remove('flip-animate');
  },300);
  updateDots();
}

prevBtn.addEventListener('click', ()=>{ goTo(current-1); });
nextBtn.addEventListener('click', ()=>{ goTo(current+1); });
window.addEventListener('keydown', (e)=>{
  if(e.key==='ArrowRight') goTo(current+1);
  if(e.key==='ArrowLeft') goTo(current-1);
});
prevBtn.addEventListener('click',(e)=>{e.stopPropagation();});
nextBtn.addEventListener('click',(e)=>{e.stopPropagation();});

function renderDots(){
  dotsContainer.innerHTML='';
  for(let i=0;i<words.length;i++){
    const span=document.createElement('span');
    if(i===current) span.classList.add('active');
    dotsContainer.appendChild(span);
  }
}
function updateDots(){
  const spans=dotsContainer.querySelectorAll('span');
  spans.forEach((s,i)=> s.classList.toggle('active', i===current));
}

renderCard(current);
renderDots();
updateDots();
</script>
</body>
</html>
